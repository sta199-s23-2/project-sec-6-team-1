------------------------------------------------------------------------

```{r}
#| label: nation_12_17
nation_12_17 <- new_drugs |>
  group_by(Year) |>
  summarize(Marijuana = sum(tot_mar_mon_12_17),
            Tobacco = sum(tot_tob_mon_12_17))

nation_longer_12_17 <- nation_12_17 |>
  pivot_longer(cols = c('Marijuana','Tobacco' ), 
               names_to = "Drug", 
               values_to = "Totals") |>
  select(c("Drug", "Totals", "Year"))

nation_longer_12_17|>
  ggplot(
    aes(x = Year, y = Totals, color = Drug)
  ) + 
  geom_line() + 
  labs(
    title = "Tobacco and Marijuana Used in the Past Month (12-17 year olds)"
  )

```

```{r}
#| label: nation_26
nation_26 <- new_drugs |>
  group_by(Year) |>
  summarize(Marijuana = sum(tot_mar_mon_26),
            Tobacco = sum(tot_tob_mon_26))

nation_longer_26 <- nation_26 |>
  pivot_longer(cols = c('Marijuana','Tobacco' ), 
               names_to = "Drug", 
               values_to = "Totals") |>
  select(c("Drug", "Totals", "Year"))

nation_longer_26|>
  ggplot(
    aes(x = Year, y = Totals, color = Drug)
  ) + 
  geom_line() +
  labs(
    title = "Tobacco and Marijuana Used in the Past Month (26+ year olds)"
  )

```

```{r}
#| label: filter_only_NC

NC <- new_drugs |>
  filter(State == "North Carolina")
NC = subset(NC, select = -c(State))
# glimpse(NC)
```

```{r}
#| label: alc_disorder_graph_12_17
NC |>
  ggplot(
    aes(x = Year, y = tot_coc_12_17)
  ) + 
  geom_line()
```

```{r}
#| label: alc_disorder_graph
tot_coc <- NC |>
  pivot_longer(cols = c('tot_coc_12_17','tot_coc_18_25','tot_coc_26' ), names_to = "Age_Range", values_to = "Total_Cocaine") |>
  select(c("Total_Cocaine", "Age_Range", "Year"))

tot_coc |>
  ggplot(
    aes(x = Year, y = Total_Cocaine, color = Age_Range)
  ) + 
  geom_line()
```

```{r}
#| label: illicit_drugs_cocaine_graph
tot_alc_dis <- NC |>
  pivot_longer(cols = c('tot_alc_dis_yr_12_17','tot_alc_dis_yr_18_25','tot_alc_dis_yr_26' ), names_to = "Age_Range", values_to = "Total_Alc_Disorder") |>
  select(c("Total_Alc_Disorder", "Age_Range", "Year"))

tot_alc_dis |>
  ggplot(
    aes(x = Year, y = Total_Alc_Disorder, color = Age_Range)
  ) + 
  geom_line()
```

```{r}
#| label: tobacco_cigarettes_graph
tot_tob_cig <- NC |>
  pivot_longer(cols = c('tot_tob_cig_mon_12_17','tot_tob_cig_mon_18_25','tot_tob_cig_mon_26' ), names_to = "Age_Range", values_to = "Total_Tob_Cig") |>
  select(c("Total_Tob_Cig", "Age_Range", "Year"))

tot_tob_cig |>
  ggplot(
    aes(x = Year, y = Total_Tob_Cig, color = Age_Range)
  ) + 
  geom_line()


```

```{r}
NC |>
  ggplot(
    aes(x = Year, y = tot_tob_cig_mon_12_17)
  ) + 
  geom_line()
```

```{r}

#| label: marijuana_new_users_graph
tot_mar <- NC |>
  pivot_longer(cols = c('tot_mar_12_17','tot_mar_18_25','tot_mar_26' ), names_to = "Age_Range", values_to = "Total_Marijuana") |>
  select(c("Total_Marijuana", "Age_Range", "Year"))

tot_mar |>
  ggplot(
    aes(x = Year, y = Total_Marijuana, color = Age_Range)
  ) + 
  geom_line()

```

```{r}

#| label: marijuana_past_year_graph
tot_mar_yr <- NC |>
  pivot_longer(cols = c('tot_mar_yr_12_17','tot_mar_yr_18_25','tot_mar_yr_26' ), names_to = "Age_Range", values_to = "Total_Marijuana_Yr") |>
  select(c("Total_Marijuana_Yr", "Age_Range", "Year"))

tot_mar_yr |>
  ggplot(
    aes(x = Year, y = Total_Marijuana_Yr, color = Age_Range)
  ) + 
  geom_line()
```

```{r}
#| label: marijuana_past_month_graph
tot_mar_mon <- NC |>
  pivot_longer(cols = c('tot_mar_mon_12_17','tot_mar_mon_18_25','tot_mar_mon_26' ), names_to = "Age_Range", values_to = "Total_Marijuana_Month") |>
  select(c("Total_Marijuana_Month", "Age_Range", "Year"))

tot_mar_mon |>
  ggplot(
    aes(x = Year, y = Total_Marijuana_Month, color = Age_Range)
  ) + 
  geom_line()
```

```{r}
NC |>
  ggplot(
    aes(x = Year, y = tot_mar_mon_12_17)
  ) + 
  geom_line()
```

```{r}
#| label: rate
NC |>
  ggplot(
    aes(x = Year, y = rate_mar_mon_12_17)
  ) + 
  geom_line()
```

```{r}
#| label: marijuana_past_month_graph
tot_tob_mon <- NC |>
  pivot_longer(cols = c('tot_tob_mon_12_17','tot_tob_mon_18_25','tot_tob_mon_26' ), names_to = "Age_Range", values_to = "Total_Tobacco_Month") |>
  select(c("Total_Tobacco_Month", "Age_Range", "Year"))

tot_tob_mon |>
  ggplot(
    aes(x = Year, y = Total_Tobacco_Month, color = Age_Range)
  ) + 
  geom_line()
```

```{r}
#| label: geomline1
NC |>
  ggplot(
    aes(x = Year, y = tot_tob_mon_12_17)
  ) + 
  geom_line()
```

```{r}
#| label: all_12_17
all_12_17 <- NC |>
  pivot_longer(cols = c('rate_alc_dis_yr_12_17','rate_alc_mon_12_17','rate_tob_cig_mon_12_17', 'rate_coc_12_17', 'rate_mar_12_17', 'rate_mar_mon_12_17', 'rate_mar_yr_12_17' , 'rate_tob_mon_12_17' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_12_17 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line()
```

```{r}
#| label: all_18_25
all_18_25 <- NC |>
  pivot_longer(cols = c('rate_alc_dis_yr_18_25','rate_alc_mon_18_25','rate_tob_cig_mon_18_25', 'rate_coc_18_25', 'rate_mar_18_25', 'rate_mar_mon_18_25', 'rate_mar_yr_18_25' , 'rate_tob_mon_18_25' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_18_25 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line()
```

```{r}
#| label: all_26
all_26 <- NC |>
  pivot_longer(cols = c('rate_alc_dis_yr_26','rate_alc_mon_26','rate_tob_cig_mon_26', 'rate_coc_26', 'rate_mar_26', 'rate_mar_mon_26', 'rate_mar_yr_26' , 'rate_tob_mon_26' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_26 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line()
```

```{r}
#| label: geomline

CO |>
  ggplot(
    aes(x = Year, y = rate_mar_26)
  ) + 
  geom_line()
```

```{r}
#| label: all_12_17
all_12_17 <- CO |>
  pivot_longer(cols = c('rate_alc_dis_yr_12_17','rate_alc_mon_12_17','rate_tob_cig_mon_12_17', 'rate_coc_12_17', 'rate_mar_12_17', 'rate_mar_mon_12_17', 'rate_mar_yr_12_17' , 'rate_tob_mon_12_17' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_12_17 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line() 
```

```{r}
#| label: all_18_25
all_18_25 <- CO |>
  pivot_longer(cols = c('rate_alc_dis_yr_18_25','rate_alc_mon_18_25','rate_tob_cig_mon_18_25', 'rate_coc_18_25', 'rate_mar_18_25', 'rate_mar_mon_18_25', 'rate_mar_yr_18_25' , 'rate_tob_mon_18_25' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_18_25 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line()
```

```{r}
#| label: all_26
all_26 <- NC |>
  pivot_longer(cols = c('rate_alc_dis_yr_26','rate_alc_mon_26','rate_tob_cig_mon_26', 'rate_coc_26', 'rate_mar_26', 'rate_mar_mon_26', 'rate_mar_yr_26' , 'rate_tob_mon_26' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_26 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line()

```