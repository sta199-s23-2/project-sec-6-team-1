---
title: "Project title"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

**Introduction and data**

Our dataset contains alcohol, cigarette, cocaine, marijuana, and tobacco use statistics for all 50 states and the District of Columbia from 2002 - 2018, broken down into three age ranges: 12-17, 18-25, and 26+. The data comes from CORGIS: The Collection of Really Great, Interesting, Situated Datasets, and was originally stored in the Substance Abuse & Mental Health Data Archive (SAMHDA). The data was gathered from the annual National Survey on Drug Use and Health.Â 

Given the increase in legalization of medical and recreational cannabis (Forbes) and the increase in tobacco prevention education (Tobacco Free Kids) in the past several decades, we wanted to explore to see if the marijuana usage has been increasing and tobacco usage has been decreasing among different age groups from 2002 to 2018. Our hypothesis is that states that legalized marijuana would experience a significant increase in marijuana usage over time. Through exploring the data, we hope to extract insights on potential causes or correlations with other variables in the data that affect trends in drug usage. There are both categorical and quantitative variables involved in our research question: the states in the data set are categorical while the totals and rates of tobacco and marijuana are quantitative.

\
**Methodology**

```{r}
#| label: load_libraries

library(tidyverse)
library(tidymodels)
library(ggplot2)
```

```{r}
#| label: load_data

drugs <- read_csv("data/drugs.csv")

```

```{r}
#| label: rename_columns

new_drugs <- drugs |>
  rename("pop_12_17" = "Population.12-17") |>
  rename("pop_18_25" = "Population.18-25") |>
  rename("pop_26" = "Population.26+") |>
  rename("tot_alc_dis_yr_12_17" = "Totals.Alcohol.Use Disorder Past Year.12-17") |>
  rename("tot_alc_dis_yr_18_25" = "Totals.Alcohol.Use Disorder Past Year.18-25") |>
  rename("tot_alc_dis_yr_26" = "Totals.Alcohol.Use Disorder Past Year.26+") |>
  rename("rate_alc_dis_yr_12_17" = "Rates.Alcohol.Use Disorder Past Year.12-17") |>
  rename("rate_alc_dis_yr_18_25" = "Rates.Alcohol.Use Disorder Past Year.18-25") |>
  rename("rate_alc_dis_yr_26" = "Rates.Alcohol.Use Disorder Past Year.26+") |>
  rename("tot_alc_mon_12_17" = "Totals.Alcohol.Use Past Month.12-17") |>
  rename("tot_alc_mon_18_25" = "Totals.Alcohol.Use Past Month.18-25") |>
  rename("tot_alc_mon_26" = "Totals.Alcohol.Use Past Month.26+") |>
  rename("rate_alc_mon_12_17" = "Rates.Alcohol.Use Past Month.12-17") |>
  rename("rate_alc_mon_18_25" = "Rates.Alcohol.Use Past Month.18-25") |>
  rename("rate_alc_mon_26" = "Rates.Alcohol.Use Past Month.26+") |>
  
  rename("tot_tob_cig_mon_12_17" = "Totals.Tobacco.Cigarette Past Month.12-17") |>
  rename("tot_tob_cig_mon_18_25" = "Totals.Tobacco.Cigarette Past Month.18-25") |>
  rename("tot_tob_cig_mon_26" = "Totals.Tobacco.Cigarette Past Month.26+") |>
  rename("rate_tob_cig_mon_12_17" = "Rates.Tobacco.Cigarette Past Month.12-17") |>
  rename("rate_tob_cig_mon_18_25" = "Rates.Tobacco.Cigarette Past Month.18-25") |>
  rename("rate_tob_cig_mon_26" = "Rates.Tobacco.Cigarette Past Month.26+") |>
  
  rename("tot_coc_12_17" = "Totals.Illicit Drugs.Cocaine Used Past Year.12-17") |>
  rename("tot_coc_18_25" = "Totals.Illicit Drugs.Cocaine Used Past Year.18-25") |>
  rename("tot_coc_26" = "Totals.Illicit Drugs.Cocaine Used Past Year.26+") |>
  rename("rate_coc_12_17" = "Rates.Illicit Drugs.Cocaine Used Past Year.12-17") |>
  rename("rate_coc_18_25" = "Rates.Illicit Drugs.Cocaine Used Past Year.18-25") |>
  rename("rate_coc_26" = "Rates.Illicit Drugs.Cocaine Used Past Year.26+") |>
  
  rename("tot_mar_12_17" = "Totals.Marijuana.New Users.12-17") |>
  rename("tot_mar_18_25" = "Totals.Marijuana.New Users.18-25") |>
  rename("tot_mar_26" = "Totals.Marijuana.New Users.26+") |>
  rename("rate_mar_12_17" = "Rates.Marijuana.New Users.12-17") |>
  rename("rate_mar_18_25" = "Rates.Marijuana.New Users.18-25") |>
  rename("rate_mar_26" = "Rates.Marijuana.New Users.26+") |>
  
  rename("tot_mar_mon_12_17" = "Totals.Marijuana.Used Past Month.12-17") |>
  rename("tot_mar_mon_18_25" = "Totals.Marijuana.Used Past Month.18-25") |>
  rename("tot_mar_mon_26" = "Totals.Marijuana.Used Past Month.26+") |>
  rename("rate_mar_mon_12_17" = "Rates.Marijuana.Used Past Month.12-17") |>
  rename("rate_mar_mon_18_25" = "Rates.Marijuana.Used Past Month.18-25") |>
  rename("rate_mar_mon_26" = "Rates.Marijuana.Used Past Month.26+") |>

  rename("tot_mar_yr_12_17" = "Totals.Marijuana.Used Past Year.12-17") |>
  rename("tot_mar_yr_18_25" = "Totals.Marijuana.Used Past Year.18-25") |>
  rename("tot_mar_yr_26" = "Totals.Marijuana.Used Past Year.26+") |>
  rename("rate_mar_yr_12_17" = "Rates.Marijuana.Used Past Year.12-17") |>
  rename("rate_mar_yr_18_25" = "Rates.Marijuana.Used Past Year.18-25") |>
  rename("rate_mar_yr_26" = "Rates.Marijuana.Used Past Year.26+") |>

  rename("tot_tob_mon_12_17" = "Totals.Tobacco.Use Past Month.12-17") |>
  rename("tot_tob_mon_18_25" = "Totals.Tobacco.Use Past Month.18-25") |>
  rename("tot_tob_mon_26" = "Totals.Tobacco.Use Past Month.26+") |>
  rename("rate_tob_mon_12_17" = "Rates.Tobacco.Use Past Month.12-17") |>
  rename("rate_tob_mon_18_25" = "Rates.Tobacco.Use Past Month.18-25") |>
  rename("rate_tob_mon_26" = "Rates.Tobacco.Use Past Month.26+")
  
```

```{r}
#| label: nation_18_25
nation_18_25 <- new_drugs |>
  group_by(Year) |>
  summarize(Marijuana = sum(tot_mar_mon_18_25)/ sum(pop_18_25),
            Tobacco = sum(tot_tob_mon_18_25)/ sum(pop_18_25))

nation_longer_18_25 <- nation_18_25 |>
  pivot_longer(cols = c('Marijuana','Tobacco' ), 
               names_to = "Drug", 
               values_to = "Rates") |>
  select(c("Drug", "Rates", "Year"))

nation_longer_18_25|>
  ggplot(
    aes(x = Year, y = Rates, color = Drug)
  ) + 
  geom_line() +
  labs(
    title = "Tobacco and Marijuana Usage Rates",
    subtitle = "18-25 year olds"
  ) +
  scale_y_continuous(labels = scales::percent)

```

```{r}
nation_18_25 |>
  filter(Year %in% c(2002, 2018))
```

Colorado (recreational legalized 2012):

```{r}

#| label: filter_only_CO

CO <- new_drugs |>
  filter(State == "Colorado")
CO = subset(CO, select = -c(State))
```

```{r}
#| label: co_18_25
CO_18_25 <- CO |>
  group_by(Year) |>
  summarize(Marijuana = tot_mar_mon_18_25/pop_18_25,
            Tobacco = tot_tob_mon_18_25/pop_18_25)

CO_longer_18_25 <- CO_18_25 |>
  pivot_longer(cols = c('Marijuana','Tobacco' ), names_to = "Drug", values_to = "Rates") |>
  select(c("Drug", "Rates", "Year"))

CO_longer_18_25|>
  ggplot(
    aes(x = Year, y = Rates, color = Drug)
  ) + 
  geom_line() +
  labs(
    title = "Tobacco and Marijuana Usage Rates in CO",
    subtitle = "18-25 year olds"
  ) +
  scale_y_continuous(labels = scales::percent)

```

NC (only CBD with THC only legalized 2015):

```{r}
#| label: filter_only_NC
NC <- new_drugs |>
  filter(State == "North Carolina")
NC = subset(NC, select = -c(State))
```

```{r}
#| label:  c_18_25
NC_18_25 <- NC |>
  group_by(Year) |>
  summarize(Marijuana = tot_mar_mon_18_25/pop_18_25,
            Tobacco = tot_tob_mon_18_25/pop_18_25)

NC_longer_18_25 <-NC_18_25 |>
  pivot_longer(cols = c('Marijuana','Tobacco' ), names_to = "Drug", values_to = "Rates") |>
  select(c("Drug", "Rates", "Year"))

NC_longer_18_25|>
  ggplot(
    aes(x = Year, y = Rates, color = Drug)
  ) + 
  geom_line() +
  labs(
    title = "Tobacco and Marijuana Usage Rates NC",
    subtitle = "18-25 year olds"
  ) +
  scale_y_continuous(labels = scales::percent)

```

**Results**

Looking at the trends in past-month marijuana usage and past-month tobacco usage across the nation, the graph "Tobacco and Marijuana Used in the Past Month (18-25 year olds)" presents a generally steady increase in Marijuana usage rates from about 0.0017% in 2002 to 0.0226% in 2018. On the other hand, Tobacco usage rates decreased considerably from about 0.0450% in 2002 to 0.0251% in 2018. In both 2002 and 2018, there is a greater rate in tobacco than marijuana usage, but decrease in tobacco usage was much greater than the increase in marijuana usage.

Considering the possibility of increased legalization of marijuana affecting the increase in marijuana usage, we isolated two states: Colorado, which was one of the first states to legalize recreational marijuana, in 2012, and North Carolina, which hasn't legalized recreational marijuana but legalized CBD with THC only in 2015. In graph "Tobacco and Marijuana Used in the Past Month in CO (18-25 year olds)," marijuana usage rates increase more than the national averages increased by, surpassing the usage rates of tobacco usage in about 2016. While the trend continues in 2012, when recreational marijuana was elgalized, there isn't a significant increase afterward compared to the increase from 2002-2012. In graph "Tobacco and Marijuana Used in the Past Month in NC (18-25 year olds)," the trends are more similar to the national average rates, where tobacco decreases at a higher rate than marijuana usage increases. But, the marijunaa usage rate in NC fluctuates much more (between around 0.015% and 0.02%) than the national average.

Overall, we can see from 2002 to 2018, there is a general decrease in tobacco usage and increase in marijuana usage, especially in states where marijuana has been legalized.

**Sources** https://www.forbes.com/health/body/cannabis-legalization-by-state/ https://www.tobaccofreekids.org/press-releases/2022_01_13_state-report-fy2022

------------------------------------------------------------------------

```{r}
#| label: nation_12_17
nation_12_17 <- new_drugs |>
  group_by(Year) |>
  summarize(Marijuana = sum(tot_mar_mon_12_17),
            Tobacco = sum(tot_tob_mon_12_17))

nation_longer_12_17 <- nation_12_17 |>
  pivot_longer(cols = c('Marijuana','Tobacco' ), 
               names_to = "Drug", 
               values_to = "Totals") |>
  select(c("Drug", "Totals", "Year"))

nation_longer_12_17|>
  ggplot(
    aes(x = Year, y = Totals, color = Drug)
  ) + 
  geom_line() + 
  labs(
    title = "Tobacco and Marijuana Used in the Past Month (12-17 year olds)"
  )

```

```{r}
#| label: nation_26
nation_26 <- new_drugs |>
  group_by(Year) |>
  summarize(Marijuana = sum(tot_mar_mon_26),
            Tobacco = sum(tot_tob_mon_26))

nation_longer_26 <- nation_26 |>
  pivot_longer(cols = c('Marijuana','Tobacco' ), 
               names_to = "Drug", 
               values_to = "Totals") |>
  select(c("Drug", "Totals", "Year"))

nation_longer_26|>
  ggplot(
    aes(x = Year, y = Totals, color = Drug)
  ) + 
  geom_line() +
  labs(
    title = "Tobacco and Marijuana Used in the Past Month (26+ year olds)"
  )

```

```{r}
#| label: filter_only_NC

NC <- new_drugs |>
  filter(State == "North Carolina")
NC = subset(NC, select = -c(State))
# glimpse(NC)
```

```{r}
#| label: alc_disorder_graph_12_17
NC |>
  ggplot(
    aes(x = Year, y = tot_coc_12_17)
  ) + 
  geom_line()
```

```{r}
#| label: alc_disorder_graph
tot_coc <- NC |>
  pivot_longer(cols = c('tot_coc_12_17','tot_coc_18_25','tot_coc_26' ), names_to = "Age_Range", values_to = "Total_Cocaine") |>
  select(c("Total_Cocaine", "Age_Range", "Year"))

tot_coc |>
  ggplot(
    aes(x = Year, y = Total_Cocaine, color = Age_Range)
  ) + 
  geom_line()
```

```{r}
#| label: illicit_drugs_cocaine_graph
tot_alc_dis <- NC |>
  pivot_longer(cols = c('tot_alc_dis_yr_12_17','tot_alc_dis_yr_18_25','tot_alc_dis_yr_26' ), names_to = "Age_Range", values_to = "Total_Alc_Disorder") |>
  select(c("Total_Alc_Disorder", "Age_Range", "Year"))

tot_alc_dis |>
  ggplot(
    aes(x = Year, y = Total_Alc_Disorder, color = Age_Range)
  ) + 
  geom_line()
```

```{r}
#| label: tobacco_cigarettes_graph
tot_tob_cig <- NC |>
  pivot_longer(cols = c('tot_tob_cig_mon_12_17','tot_tob_cig_mon_18_25','tot_tob_cig_mon_26' ), names_to = "Age_Range", values_to = "Total_Tob_Cig") |>
  select(c("Total_Tob_Cig", "Age_Range", "Year"))

tot_tob_cig |>
  ggplot(
    aes(x = Year, y = Total_Tob_Cig, color = Age_Range)
  ) + 
  geom_line()


```

```{r}
NC |>
  ggplot(
    aes(x = Year, y = tot_tob_cig_mon_12_17)
  ) + 
  geom_line()
```

```{r}

#| label: marijuana_new_users_graph
tot_mar <- NC |>
  pivot_longer(cols = c('tot_mar_12_17','tot_mar_18_25','tot_mar_26' ), names_to = "Age_Range", values_to = "Total_Marijuana") |>
  select(c("Total_Marijuana", "Age_Range", "Year"))

tot_mar |>
  ggplot(
    aes(x = Year, y = Total_Marijuana, color = Age_Range)
  ) + 
  geom_line()

```

```{r}

#| label: marijuana_past_year_graph
tot_mar_yr <- NC |>
  pivot_longer(cols = c('tot_mar_yr_12_17','tot_mar_yr_18_25','tot_mar_yr_26' ), names_to = "Age_Range", values_to = "Total_Marijuana_Yr") |>
  select(c("Total_Marijuana_Yr", "Age_Range", "Year"))

tot_mar_yr |>
  ggplot(
    aes(x = Year, y = Total_Marijuana_Yr, color = Age_Range)
  ) + 
  geom_line()
```

```{r}
#| label: marijuana_past_month_graph
tot_mar_mon <- NC |>
  pivot_longer(cols = c('tot_mar_mon_12_17','tot_mar_mon_18_25','tot_mar_mon_26' ), names_to = "Age_Range", values_to = "Total_Marijuana_Month") |>
  select(c("Total_Marijuana_Month", "Age_Range", "Year"))

tot_mar_mon |>
  ggplot(
    aes(x = Year, y = Total_Marijuana_Month, color = Age_Range)
  ) + 
  geom_line()
```

```{r}
NC |>
  ggplot(
    aes(x = Year, y = tot_mar_mon_12_17)
  ) + 
  geom_line()
```

```{r}
NC |>
  ggplot(
    aes(x = Year, y = rate_mar_mon_12_17)
  ) + 
  geom_line()
```

```{r}
#| label: marijuana_past_month_graph
tot_tob_mon <- NC |>
  pivot_longer(cols = c('tot_tob_mon_12_17','tot_tob_mon_18_25','tot_tob_mon_26' ), names_to = "Age_Range", values_to = "Total_Tobacco_Month") |>
  select(c("Total_Tobacco_Month", "Age_Range", "Year"))

tot_tob_mon |>
  ggplot(
    aes(x = Year, y = Total_Tobacco_Month, color = Age_Range)
  ) + 
  geom_line()
```

```{r}
NC |>
  ggplot(
    aes(x = Year, y = tot_tob_mon_12_17)
  ) + 
  geom_line()
```

```{r}
#| label: all_12_17
all_12_17 <- NC |>
  pivot_longer(cols = c('rate_alc_dis_yr_12_17','rate_alc_mon_12_17','rate_tob_cig_mon_12_17', 'rate_coc_12_17', 'rate_mar_12_17', 'rate_mar_mon_12_17', 'rate_mar_yr_12_17' , 'rate_tob_mon_12_17' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_12_17 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line()
```

```{r}
#| label: all_18_25
all_18_25 <- NC |>
  pivot_longer(cols = c('rate_alc_dis_yr_18_25','rate_alc_mon_18_25','rate_tob_cig_mon_18_25', 'rate_coc_18_25', 'rate_mar_18_25', 'rate_mar_mon_18_25', 'rate_mar_yr_18_25' , 'rate_tob_mon_18_25' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_18_25 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line()
```

```{r}
#| label: all_26
all_26 <- NC |>
  pivot_longer(cols = c('rate_alc_dis_yr_26','rate_alc_mon_26','rate_tob_cig_mon_26', 'rate_coc_26', 'rate_mar_26', 'rate_mar_mon_26', 'rate_mar_yr_26' , 'rate_tob_mon_26' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_26 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line()
```

```{r}
CO |>
  ggplot(
    aes(x = Year, y = rate_mar_26)
  ) + 
  geom_line()
```

```{r}
#| label: all_12_17
all_12_17 <- CO |>
  pivot_longer(cols = c('rate_alc_dis_yr_12_17','rate_alc_mon_12_17','rate_tob_cig_mon_12_17', 'rate_coc_12_17', 'rate_mar_12_17', 'rate_mar_mon_12_17', 'rate_mar_yr_12_17' , 'rate_tob_mon_12_17' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_12_17 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line() 
```

```{r}
#| label: all_18_25
all_18_25 <- CO |>
  pivot_longer(cols = c('rate_alc_dis_yr_18_25','rate_alc_mon_18_25','rate_tob_cig_mon_18_25', 'rate_coc_18_25', 'rate_mar_18_25', 'rate_mar_mon_18_25', 'rate_mar_yr_18_25' , 'rate_tob_mon_18_25' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_18_25 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line()
```

```{r}
#| label: all_26
all_26 <- NC |>
  pivot_longer(cols = c('rate_alc_dis_yr_26','rate_alc_mon_26','rate_tob_cig_mon_26', 'rate_coc_26', 'rate_mar_26', 'rate_mar_mon_26', 'rate_mar_yr_26' , 'rate_tob_mon_26' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_26 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line()
```
