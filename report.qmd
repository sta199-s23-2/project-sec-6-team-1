---
title: "Project title"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

**Introduction and data**

The source of the data is from CORGIS: The Collection of Really Great, Interesting, Situated Datasets, originally stored in the Substance Abuse & Mental Health Data Archive (SAMHDA). The data in the data set was collected from individual states from the National Survey on Drug Use and Health, which is taken once a year. The data ranges from 2002 to 2018. From the data, we can see that every state in the United States (including DC) is accounted for each year. The different drugs recorded in the data set are alcohol, tobacco, cocaine, and marijuana as well as an age range for each of them. There are 3 age ranges from 12-17, 18-25, and 26+. Also, there are totals and rates for each of the drugs that are recorded in the data set.

Are there more people aged 18-25 using more tobacco or marijuana in the past month in 2018? What about in 2002? How has the usage of tobacco and marijuana changes from 2002 to 2018? Given the increase in legalization of medical and recreational cannabis and the increase in tobacco prevention education in the past several decades, we wanted to explore to see if the marijuana usage has been increasing and tobacco usage has been decreasing in all the age groups from 2002 to 2018. One guess would be that states that legalized marijuana would experience a significant increase in marijuana usage or higher rates overall. Through exploring the data, we hope to extract insights on potential causes or correlations with other variables in the data that affect the trends in drug usage. There are both categorical and quantitative variables involved in our research question. The states in the data set are categorical while the totals and rates of tobacco and marijuana are quantitative.


**CITE SOURCES ON INCREASED LEGALIZATION AND EDUCATION **

**Methodology**
```{r}
#| label: load_libraries

library(tidyverse)
library(tidymodels)
library(ggplot2)
```

```{r}
#| label: load_data

drugs <- read_csv("data/drugs.csv")

```

```{r}
#| label: rename_columns

new_drugs <- drugs |>
  rename("pop_12_17" = "Population.12-17") |>
  rename("pop_18_25" = "Population.18-25") |>
  rename("pop_26" = "Population.26+") |>
  rename("tot_alc_dis_yr_12_17" = "Totals.Alcohol.Use Disorder Past Year.12-17") |>
  rename("tot_alc_dis_yr_18_25" = "Totals.Alcohol.Use Disorder Past Year.18-25") |>
  rename("tot_alc_dis_yr_26" = "Totals.Alcohol.Use Disorder Past Year.26+") |>
  rename("rate_alc_dis_yr_12_17" = "Rates.Alcohol.Use Disorder Past Year.12-17") |>
  rename("rate_alc_dis_yr_18_25" = "Rates.Alcohol.Use Disorder Past Year.18-25") |>
  rename("rate_alc_dis_yr_26" = "Rates.Alcohol.Use Disorder Past Year.26+") |>
  rename("tot_alc_mon_12_17" = "Totals.Alcohol.Use Past Month.12-17") |>
  rename("tot_alc_mon_18_25" = "Totals.Alcohol.Use Past Month.18-25") |>
  rename("tot_alc_mon_26" = "Totals.Alcohol.Use Past Month.26+") |>
  rename("rate_alc_mon_12_17" = "Rates.Alcohol.Use Past Month.12-17") |>
  rename("rate_alc_mon_18_25" = "Rates.Alcohol.Use Past Month.18-25") |>
  rename("rate_alc_mon_26" = "Rates.Alcohol.Use Past Month.26+") |>
  
  rename("tot_tob_cig_mon_12_17" = "Totals.Tobacco.Cigarette Past Month.12-17") |>
  rename("tot_tob_cig_mon_18_25" = "Totals.Tobacco.Cigarette Past Month.18-25") |>
  rename("tot_tob_cig_mon_26" = "Totals.Tobacco.Cigarette Past Month.26+") |>
  rename("rate_tob_cig_mon_12_17" = "Rates.Tobacco.Cigarette Past Month.12-17") |>
  rename("rate_tob_cig_mon_18_25" = "Rates.Tobacco.Cigarette Past Month.18-25") |>
  rename("rate_tob_cig_mon_26" = "Rates.Tobacco.Cigarette Past Month.26+") |>
  
  rename("tot_coc_12_17" = "Totals.Illicit Drugs.Cocaine Used Past Year.12-17") |>
  rename("tot_coc_18_25" = "Totals.Illicit Drugs.Cocaine Used Past Year.18-25") |>
  rename("tot_coc_26" = "Totals.Illicit Drugs.Cocaine Used Past Year.26+") |>
  rename("rate_coc_12_17" = "Rates.Illicit Drugs.Cocaine Used Past Year.12-17") |>
  rename("rate_coc_18_25" = "Rates.Illicit Drugs.Cocaine Used Past Year.18-25") |>
  rename("rate_coc_26" = "Rates.Illicit Drugs.Cocaine Used Past Year.26+") |>
  
  rename("tot_mar_12_17" = "Totals.Marijuana.New Users.12-17") |>
  rename("tot_mar_18_25" = "Totals.Marijuana.New Users.18-25") |>
  rename("tot_mar_26" = "Totals.Marijuana.New Users.26+") |>
  rename("rate_mar_12_17" = "Rates.Marijuana.New Users.12-17") |>
  rename("rate_mar_18_25" = "Rates.Marijuana.New Users.18-25") |>
  rename("rate_mar_26" = "Rates.Marijuana.New Users.26+") |>
  
  rename("tot_mar_mon_12_17" = "Totals.Marijuana.Used Past Month.12-17") |>
  rename("tot_mar_mon_18_25" = "Totals.Marijuana.Used Past Month.18-25") |>
  rename("tot_mar_mon_26" = "Totals.Marijuana.Used Past Month.26+") |>
  rename("rate_mar_mon_12_17" = "Rates.Marijuana.Used Past Month.12-17") |>
  rename("rate_mar_mon_18_25" = "Rates.Marijuana.Used Past Month.18-25") |>
  rename("rate_mar_mon_26" = "Rates.Marijuana.Used Past Month.26+") |>

  rename("tot_mar_yr_12_17" = "Totals.Marijuana.Used Past Year.12-17") |>
  rename("tot_mar_yr_18_25" = "Totals.Marijuana.Used Past Year.18-25") |>
  rename("tot_mar_yr_26" = "Totals.Marijuana.Used Past Year.26+") |>
  rename("rate_mar_yr_12_17" = "Rates.Marijuana.Used Past Year.12-17") |>
  rename("rate_mar_yr_18_25" = "Rates.Marijuana.Used Past Year.18-25") |>
  rename("rate_mar_yr_26" = "Rates.Marijuana.Used Past Year.26+") |>

  rename("tot_tob_mon_12_17" = "Totals.Tobacco.Use Past Month.12-17") |>
  rename("tot_tob_mon_18_25" = "Totals.Tobacco.Use Past Month.18-25") |>
  rename("tot_tob_mon_26" = "Totals.Tobacco.Use Past Month.26+") |>
  rename("rate_tob_mon_12_17" = "Rates.Tobacco.Use Past Month.12-17") |>
  rename("rate_tob_mon_18_25" = "Rates.Tobacco.Use Past Month.18-25") |>
  rename("rate_tob_mon_26" = "Rates.Tobacco.Use Past Month.26+")
  
```

```{r}
#| label: nation_12_17
nation_12_17 <- new_drugs |>
  group_by(Year) |>
  summarize(Marijuana = sum(tot_mar_mon_12_17),
            Tobacco = sum(tot_tob_mon_12_17))

nation_longer_12_17 <- nation_12_17 |>
  pivot_longer(cols = c('Marijuana','Tobacco' ), 
               names_to = "Drug", 
               values_to = "Totals") |>
  select(c("Drug", "Totals", "Year"))

nation_longer_12_17|>
  ggplot(
    aes(x = Year, y = Totals, color = Drug)
  ) + 
  geom_line() + 
  labs(
    title = "Tobacco and Marijuana Used in the Past Month (12-17 year olds)"
  )

```

```{r}
#| label: nation_18_25
nation_18_25 <- new_drugs |>
  group_by(Year) |>
  summarize(Marijuana = sum(tot_mar_mon_18_25),
            Tobacco = sum(tot_tob_mon_18_25))

nation_longer_18_25 <- nation_18_25 |>
  pivot_longer(cols = c('Marijuana','Tobacco' ), names_to = "Drug", values_to = "Totals") |>
  select(c("Drug", "Totals", "Year"))

nation_longer_18_25|>
  ggplot(
    aes(x = Year, y = Totals, color = Drug)
  ) + 
  geom_line() +
  labs(
    title = "Tobacco and Marijuana Used in the Past Month (18-25 year olds)"
  )

```

```{r}
#| label: nation_26
nation_26 <- new_drugs |>
  group_by(Year) |>
  summarize(Marijuana = sum(tot_mar_mon_26),
            Tobacco = sum(tot_tob_mon_26))

nation_longer_26 <- nation_26 |>
  pivot_longer(cols = c('Marijuana','Tobacco' ), names_to = "Drug", values_to = "Totals") |>
  select(c("Drug", "Totals", "Year"))

nation_longer_26|>
  ggplot(
    aes(x = Year, y = Totals, color = Drug)
  ) + 
  geom_line() +
  labs(
    title = "Tobacco and Marijuana Used in the Past Month (26+ year olds)"
  )

```

Comparing CO (recreational legalized 2012) vs NC (not legalized)

CO:

```{r}

#| label: filter_only_CO

CO <- new_drugs |>
  filter(State == "Colorado")
CO = subset(CO, select = -c(State))


```

```{r}
#| label: co_18_25
CO_18_25 <- CO |>
  group_by(Year) |>
  summarize(Marijuana = tot_mar_mon_18_25,
            Tobacco = tot_tob_mon_18_25)

CO_longer_18_25 <- CO_18_25 |>
  pivot_longer(cols = c('Marijuana','Tobacco' ), names_to = "Drug", values_to = "Totals") |>
  select(c("Drug", "Totals", "Year"))

CO_longer_18_25|>
  ggplot(
    aes(x = Year, y = Totals, color = Drug)
  ) + 
  geom_line() +
  labs(
    title = "Tobacco and Marijuana Used in the Past Month in CO (18-25 year olds)"
  )

```

NC:

```{r}

#| label: filter_only_NC

NC <- new_drugs |>
  filter(State == "North Carolina")
NC = subset(CO, select = -c(State))


```

```{r}
#| label:  c_18_25
NC_18_25 <- NC |>
  group_by(Year) |>
  summarize(Marijuana = tot_mar_mon_18_25,
            Tobacco = tot_tob_mon_18_25)

NC_longer_18_25 <-NC_18_25 |>
  pivot_longer(cols = c('Marijuana','Tobacco' ), names_to = "Drug", values_to = "Totals") |>
  select(c("Drug", "Totals", "Year"))

NC_longer_18_25|>
  ggplot(
    aes(x = Year, y = Totals, color = Drug)
  ) + 
  geom_line() +
  labs(
    title = "Tobacco and Marijuana Used in the Past Month in NC (18-25 year olds)"
  )

```

The methodology section should include visualizations and summary statistics relevant to your research question. You should also justify the choice of statistical method(s) used to answer your research question.

**Results**

Showcase how you arrived at answers to your research question using the techniques we have learned in class (and beyond, if you're feeling adventurous).

Provide only the main results from your analysis. The goal is not to do an exhaustive data analysis (calculate every possible statistic and perform every possible procedure for all variables). Rather, you should demonstrate that you are proficient at asking meaningful questions and answering them using data, that you are skilled in interpreting and presenting results, and that you can accomplish these tasks using R. More is not better.



______



```{r}
#| label: filter_only_NC

NC <- new_drugs |>
  filter(State == "North Carolina")
NC = subset(NC, select = -c(State))
# glimpse(NC)
```

```{r}
#| label: alc_disorder_graph_12_17
NC |>
  ggplot(
    aes(x = Year, y = tot_coc_12_17)
  ) + 
  geom_line()
```

```{r}
#| label: alc_disorder_graph
tot_coc <- NC |>
  pivot_longer(cols = c('tot_coc_12_17','tot_coc_18_25','tot_coc_26' ), names_to = "Age_Range", values_to = "Total_Cocaine") |>
  select(c("Total_Cocaine", "Age_Range", "Year"))

tot_coc |>
  ggplot(
    aes(x = Year, y = Total_Cocaine, color = Age_Range)
  ) + 
  geom_line()
```

```{r}
#| label: illicit_drugs_cocaine_graph
tot_alc_dis <- NC |>
  pivot_longer(cols = c('tot_alc_dis_yr_12_17','tot_alc_dis_yr_18_25','tot_alc_dis_yr_26' ), names_to = "Age_Range", values_to = "Total_Alc_Disorder") |>
  select(c("Total_Alc_Disorder", "Age_Range", "Year"))

tot_alc_dis |>
  ggplot(
    aes(x = Year, y = Total_Alc_Disorder, color = Age_Range)
  ) + 
  geom_line()
```

```{r}
#| label: tobacco_cigarettes_graph
tot_tob_cig <- NC |>
  pivot_longer(cols = c('tot_tob_cig_mon_12_17','tot_tob_cig_mon_18_25','tot_tob_cig_mon_26' ), names_to = "Age_Range", values_to = "Total_Tob_Cig") |>
  select(c("Total_Tob_Cig", "Age_Range", "Year"))

tot_tob_cig |>
  ggplot(
    aes(x = Year, y = Total_Tob_Cig, color = Age_Range)
  ) + 
  geom_line()


```

```{r}
NC |>
  ggplot(
    aes(x = Year, y = tot_tob_cig_mon_12_17)
  ) + 
  geom_line()
```

```{r}

#| label: marijuana_new_users_graph
tot_mar <- NC |>
  pivot_longer(cols = c('tot_mar_12_17','tot_mar_18_25','tot_mar_26' ), names_to = "Age_Range", values_to = "Total_Marijuana") |>
  select(c("Total_Marijuana", "Age_Range", "Year"))

tot_mar |>
  ggplot(
    aes(x = Year, y = Total_Marijuana, color = Age_Range)
  ) + 
  geom_line()

```

```{r}

#| label: marijuana_past_year_graph
tot_mar_yr <- NC |>
  pivot_longer(cols = c('tot_mar_yr_12_17','tot_mar_yr_18_25','tot_mar_yr_26' ), names_to = "Age_Range", values_to = "Total_Marijuana_Yr") |>
  select(c("Total_Marijuana_Yr", "Age_Range", "Year"))

tot_mar_yr |>
  ggplot(
    aes(x = Year, y = Total_Marijuana_Yr, color = Age_Range)
  ) + 
  geom_line()
```

```{r}
#| label: marijuana_past_month_graph
tot_mar_mon <- NC |>
  pivot_longer(cols = c('tot_mar_mon_12_17','tot_mar_mon_18_25','tot_mar_mon_26' ), names_to = "Age_Range", values_to = "Total_Marijuana_Month") |>
  select(c("Total_Marijuana_Month", "Age_Range", "Year"))

tot_mar_mon |>
  ggplot(
    aes(x = Year, y = Total_Marijuana_Month, color = Age_Range)
  ) + 
  geom_line()
```

```{r}
NC |>
  ggplot(
    aes(x = Year, y = tot_mar_mon_12_17)
  ) + 
  geom_line()
```

```{r}
NC |>
  ggplot(
    aes(x = Year, y = rate_mar_mon_12_17)
  ) + 
  geom_line()
```

```{r}
#| label: marijuana_past_month_graph
tot_tob_mon <- NC |>
  pivot_longer(cols = c('tot_tob_mon_12_17','tot_tob_mon_18_25','tot_tob_mon_26' ), names_to = "Age_Range", values_to = "Total_Tobacco_Month") |>
  select(c("Total_Tobacco_Month", "Age_Range", "Year"))

tot_tob_mon |>
  ggplot(
    aes(x = Year, y = Total_Tobacco_Month, color = Age_Range)
  ) + 
  geom_line()
```

```{r}
NC |>
  ggplot(
    aes(x = Year, y = tot_tob_mon_12_17)
  ) + 
  geom_line()
```

```{r}
#| label: all_12_17
all_12_17 <- NC |>
  pivot_longer(cols = c('rate_alc_dis_yr_12_17','rate_alc_mon_12_17','rate_tob_cig_mon_12_17', 'rate_coc_12_17', 'rate_mar_12_17', 'rate_mar_mon_12_17', 'rate_mar_yr_12_17' , 'rate_tob_mon_12_17' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_12_17 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line()
```

```{r}
#| label: all_18_25
all_18_25 <- NC |>
  pivot_longer(cols = c('rate_alc_dis_yr_18_25','rate_alc_mon_18_25','rate_tob_cig_mon_18_25', 'rate_coc_18_25', 'rate_mar_18_25', 'rate_mar_mon_18_25', 'rate_mar_yr_18_25' , 'rate_tob_mon_18_25' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_18_25 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line()
```

```{r}
#| label: all_26
all_26 <- NC |>
  pivot_longer(cols = c('rate_alc_dis_yr_26','rate_alc_mon_26','rate_tob_cig_mon_26', 'rate_coc_26', 'rate_mar_26', 'rate_mar_mon_26', 'rate_mar_yr_26' , 'rate_tob_mon_26' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_26 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line()
```



```{r}
CO |>
  ggplot(
    aes(x = Year, y = rate_mar_26)
  ) + 
  geom_line()
```


```{r}
#| label: all_12_17
all_12_17 <- CO |>
  pivot_longer(cols = c('rate_alc_dis_yr_12_17','rate_alc_mon_12_17','rate_tob_cig_mon_12_17', 'rate_coc_12_17', 'rate_mar_12_17', 'rate_mar_mon_12_17', 'rate_mar_yr_12_17' , 'rate_tob_mon_12_17' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_12_17 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line()
```

```{r}
#| label: all_18_25
all_18_25 <- CO |>
  pivot_longer(cols = c('rate_alc_dis_yr_18_25','rate_alc_mon_18_25','rate_tob_cig_mon_18_25', 'rate_coc_18_25', 'rate_mar_18_25', 'rate_mar_mon_18_25', 'rate_mar_yr_18_25' , 'rate_tob_mon_18_25' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_18_25 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line()
```

```{r}
#| label: all_26
all_26 <- NC |>
  pivot_longer(cols = c('rate_alc_dis_yr_26','rate_alc_mon_26','rate_tob_cig_mon_26', 'rate_coc_26', 'rate_mar_26', 'rate_mar_mon_26', 'rate_mar_yr_26' , 'rate_tob_mon_26' ), names_to = "Type", values_to = "Rates") |>
  select(c("Type", "Rates", "Year"))

all_26 |>
  ggplot(
    aes(x = Year, y = Rates, color = Type)
  ) + 
  geom_line()
```




